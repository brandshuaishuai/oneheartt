function vgseEscapeHTML(e){var t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};return e.replace(/[&<>"']/g,function(e){return t[e]})}function vgseToggleFullScreen(e){jQuery(".wpse-full-screen-notice-content.notice-on").is(":visible")?(jQuery(".wpse-full-screen-notice-content.notice-on").hide(),jQuery(".wpse-full-screen-notice-content.notice-off").show(),jQuery("html").removeClass("wpse-full-screen")):(jQuery(".wpse-full-screen-notice-content.notice-on").show(),jQuery(".wpse-full-screen-notice-content.notice-off").hide(),jQuery("html").addClass("wpse-full-screen"))}function vgseFormatDate(){var e=new Date,t=""+(e.getMonth()+1),o=""+e.getDate(),r=e.getFullYear();return t.length<2&&(t="0"+t),o.length<2&&(o="0"+o),[r,t,o].join("-")}function vgseGuidGenerator(){var e=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)};return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}function vgseCustomTooltip(e,t,o,r){o||(o="bottom"),e.tipso({position:o,tooltipHover:!0,content:t}).tipso("show"),r&&(e.hover(function(){e.tipso("hide")}),setTimeout(function(){e.tipso("hide")},8e3)),setTimeout(function(){e.tipso("hide"),r||e.tipso("destroy")},8e3)}function beParseParams(e){for(var t={},o=e.split("&"),r=0;r<o.length;r++){var n=o[r].split("=");if(n[0]=decodeURIComponent(n[0]),void 0===t[n[0]])t[n[0]]=n[1];else if("string"==typeof t[n[0]]){var a=[t[n[0]],n[1]];t[n[0]]=a}else t[n[0]].push(n[1])}return t}function beGetRowsFilters(){return jQuery("body").data("be-filters")?jQuery.param(jQuery("body").data("be-filters")):""}function beAddRowsFilter(e){if(!e)return!1;var t=jQuery("body").data("be-filters");t||(t={});var o="string"==typeof e?beParseParams(e):e,r=jQuery.extend(t,o),n=jQuery(".vgse-current-filters");return n.find(".button").remove(),n.each(function(){var s=jQuery(this);jQuery.each(r,function(e,t){if(t&&e.indexOf("meta_query")<0){var o="string"==typeof t?t:t.join(", ");20<(o=jQuery("<span>"+o+"</span>").text()).length&&(o=o.substring(0,20)+"...");var r=e.replace("[]","");s.append('<a href="#" class="button" data-filter-key="'+e+'"><i class="fa fa-remove"></i> '+r+": "+o+"</a>")}}),r.meta_query&&jQuery.each(r.meta_query,function(e,t){var o=t.key;if(o){var r=t.value,n=t.compare;20<(r=jQuery("<span>"+r+"</span>").text()).length&&(r=r.substring(0,20)+"..."),s.append('<a href="#" class="button advanced-filter" data-filter-key="meta_query"><i class="fa fa-remove"></i> '+o+" "+n+" "+r+"</a>")}}),jQuery(".advanced-filters-list > li").each(function(){var e=jQuery(this),t=e.find(".wpse-advanced-filters-field-selector"),o=t.val();if(o){var r=t.attr("name"),n=e.find(".wpse-advanced-filters-value-selector").val(),a=e.find(".wpse-advanced-filters-operator-selector option:selected").text(),i="string"==typeof n?n:n.join(", ");20<(i=jQuery("<span>"+i+"</span>").text()).length&&(i=i.substring(0,20)+"..."),s.append('<a href="#" class="button advanced-filter" data-filter-key="'+r+'"><i class="fa fa-remove"></i> '+o+" "+a+" "+i+"</a>")}}),s.find(".button").length?s.show():s.hide()}),jQuery("body").data("be-filters",r),r}function beAjaxLoop(e){var o=jQuery.extend({totalCalls:null,current:1,url:"",method:"GET",dataType:"json",data:{},prepareData:function(e,t){return e},onSuccess:function(e,t){},onError:function(e,t,o){},status:"running"},e);function r(){if(o.current<o.totalCalls+1){if("running"!==o.status)return!0;jQuery.isArray(o.data)?(o.data.push({name:"page",value:o.current}),o.data.push({name:"totalCalls",value:o.totalCalls})):(o.data.page=o.current,o.data.totalCalls=o.totalCalls);var e={url:o.url,dataType:o.dataType,data:o.prepareData(o.data,o),method:o.method};jQuery.ajax(e).done(function(e){o.onSuccess(e,o)&&(o.current++,setTimeout(function(){r()},1e3*parseInt(vgse_editor_settings.wait_between_batches)))}).fail(function(e,t){o.onError(e,t,o)&&(o.current++,setTimeout(function(){r()},1e3*parseInt(vgse_editor_settings.wait_between_batches)))})}}return r(),{pause:function(){o.status="paused"},resume:function(){o.status="running",r()}}}function loading_ajax(e){"boolean"==typeof e&&(e={estado:e});var t={estado:!0};jQuery.extend(t,e),1==t.estado?(jQuery("body").find(".sombra_popup").length||jQuery("body").append('<div class="sombra_popup be-ajax"><div class="sk-three-bounce"><div class="sk-child sk-bounce1"></div><div class="sk-child sk-bounce2"></div><div class="sk-child sk-bounce3"></div></div></div>'),jQuery(".sombra_popup").fadeIn(1e3)):jQuery(".sombra_popup").fadeOut(800,function(){})}function notification(e){var t={tipo:"success",mensaje:"",time:8600,position:"top"};jQuery.extend(t,e),setTimeout(function(){if("success"==t.tipo)var e="green";else if("error"==t.tipo)e="red";else if("warning"==t.tipo)e="orange";else e="blue";"bottom"===t.position?jQuery("#ohsnap").css({top:"auto",bottom:"5px"}):jQuery("#ohsnap").css({top:"",bottom:""}),jQuery("#ohsnap").css("z-index","1100000"),setTimeout(function(){jQuery("#ohsnap").css("z-index","-1")},t.time),ohSnap(t.mensaje,{duration:t.time,color:e})},500)}function beLoadPosts(t,o,r,n){loading_ajax({estado:!0});var a=setTimeout(function(){jQuery(".wpse-stuck-loading").css("display","block")},5e3);r||(r=!0),n||(n=!1),t.action="vgse_load_data",t.wpse_source_suffix=vgse_editor_settings.wpse_source_suffix||"",t.paged||(t.paged=1),window.beCurrentPage=t.paged,t.filters=beGetRowsFilters(),window.beLastLoadRowsAjax=jQuery.ajax({url:ajaxurl,dataType:"json",type:"POST",data:t}).success(function(e){if(jQuery(".wpse-stuck-loading").hide(),clearTimeout(a),jQuery("body").trigger("vgSheetEditor:beforeRowsInsert",[e,t,o,r,n]),"function"==typeof o&&(o(e),r))return!0;e.success?(vgseAddFoundRowsCount(e.data.total),vgAddRowsToSheet(e.data.rows,null,n),notification({mensaje:e.data.message||vgse_editor_settings.texts.posts_loaded,tipo:"info"}),loading_ajax({estado:!1})):(loading_ajax({estado:!1}),notification({mensaje:e.data.message,tipo:"info"}),vgseAddFoundRowsCount(0))})}function beSetSaveButtonStatus(e){var t=jQuery("#vg-header-toolbar .wpse-save");e?(t.attr("data-remodal-target","bulk-save"),t.removeClass("disabled")):(t.removeAttr("data-remodal-target"),t.addClass("disabled"))}function beDeduplicateItems(e){if(!e||!e.length)return e;var r={},n=e[0]instanceof Array?"array":"object";return jQuery.each(e,function(e,t){var o="array"===n?t[0]:t.ID;"string"==typeof o&&(o=parseInt(o)),r[o]||(r[o]=t)}),r}function beGetModifiedObjectProperties(t,o){var r={};return Object.keys(o).forEach(function(e){t&&void 0!==t[e]&&o[e]==t[e]||(r[e]=o[e])}),r}function beArraysIdenticalCheck(e,t){if(e.length!==t.length)return!1;for(var o=e.length;o--;)if(e[o]!==t[o])return!1;return!0}function beGetModifiedItems(n,a){if(!n)n=hot.getSourceData();if(!a)a=window.beOriginalData;n=beDeduplicateItems(n),a=beDeduplicateItems(a);var i=[];return jQuery.each(n,function(e,t){var o,r=beGetModifiedObjectProperties(a[e],n[e]);void 0!==a[e]&&jQuery.isEmptyObject(r)||(o=!a[e]||a[e].provider&&vgse_editor_settings.saveFullRowPostTypes&&-1<vgse_editor_settings.saveFullRowPostTypes.indexOf(a[e].provider)?n[e]:(r.ID=e,r),i.push(o))}),i}function beGetTinymceContent(){if("none"!==jQuery(".wp-editor-area").css("display"))var e=jQuery(".wp-editor-area").val()||"";else if(document.getElementById("editpost_ifr"))e=(document.getElementById("editpost_ifr").contentWindow.document||document.getElementById("editpost_ifr").contentDocument).body.innerHTML;else e="";return e}function vgseExecuteFunctionByName(e,t){e=jQuery.trim(e);for(var o=[].slice.call(arguments).splice(2),r=e.split("."),n=r.pop(),a=0;a<r.length;a++)t=t[r[a]];return t[n].apply(t,o)}function vgObjectToArray(e){var t=[];for(var o in e)t.push(e[o]);return t}function _debounce(t,o,r){var n,a,i,s,u,d=function(){var e=_now()-s;e<o&&0<=e?n=setTimeout(d,o-e):(n=null,r||(u=t.apply(i,a),n||(i=a=null)))};return function(){i=this,a=arguments,s=_now();var e=r&&!n;return n||(n=setTimeout(d,o)),e&&(u=t.apply(i,a),i=a=null),u}}function _now(){return Date.now()||(new Date).getTime()}function _throttle(o,r,n){var a,i,s;r||(r=300);var u=null,d=0;n||(n={});var c=function(){d=!1===n.leading?0:_now(),u=null,s=o.apply(a,i),u||(a=i=null)};return function(){var e=_now();d||!1!==n.leading||(d=e);var t=r-(e-d);return a=this,i=arguments,t<=0||r<t?(u&&(clearTimeout(u),u=null),d=e,s=o.apply(a,i),u||(a=i=null)):u||!1===n.trailing||(u=setTimeout(c,t)),s}}function vgseRemoveRowFromSheetByID(e){if(e.length){var t=hot.getSourceData();e.forEach(function(e){t=vgseRemovePostFromSheet(e,t)}),hot.loadData(t)}}function vgseRemovePostFromSheet(r,e){var n=[];return r=parseInt(r),e.forEach(function(e,t){var o=jQuery.extend(!0,{},e);"string"==typeof o.ID&&(o.ID=parseInt(o.ID)),r!==o.ID&&n.push(e)}),n}function vgAddRowsToSheet(e,t,o){t||(t="append"),e||(e=[]),"prepend"===t&&(e=e.reverse());var r=hot.getSourceData();o&&e.forEach(function(e,t){var o=jQuery.extend(!0,{},e);o.ID=parseInt(o.ID),r=vgseRemovePostFromSheet(o.ID,r)});var n=r.map(function(e){return e.ID});for(i=0;i<e.length;i++)n.indexOf(e[i].ID)<0&&("append"===t?r.push(jQuery.extend(!0,{},e[i])):r.unshift(jQuery.extend(!0,{},e[i])));hot.loadData(r),jQuery("body").trigger("vgSheetEditor:afterRowsInsert",[e,t,o]),window.beOriginalData||(window.beOriginalData=[]),window.beOriginalData=jQuery.merge(window.beOriginalData,e)}function wpsePrepareGalleryFilesForCellFormat(e,t){var o=hot.colToProp(t.col),r=vgse_editor_settings.final_spreadsheet_columns_settings[o],n=r&&void 0!==r.wp_media_multiple&&r.wp_media_multiple,a=hot.getDataAtCell(t.row,t.col),i=n&&a?a.split(","):[];jQuery.each(e,function(e,t){i.push(t.url+"?wpId="+t.id)}),hot.setDataAtCell(t.row,t.col,i.join(","))}function vgseInitSelect2(e){if(!e)e=jQuery("select.select2");e.each(function(){var e={placeholder:jQuery(this).data("placeholder"),minimumInputLength:jQuery(this).data("min-input-length")||0,allowClear:!0};jQuery(this).data("remote")&&(e.ajax={url:ajaxurl,delay:1e3,data:function(e){return{search:e.term,page:e.page,action:jQuery(this).data("action"),global_search:jQuery(this).data("global-search")||"",output_format:jQuery(this).data("output-format"),post_type:jQuery(this).data("post-type")||jQuery("#post-data").data("post-type"),nonce:jQuery("#vgse-wrapper").data("nonce")}},processResults:function(e){return e.success?{results:e.data.data}:{results:[]}},cache:!0}),jQuery(this).select2(e)})}function vgseReloadSpreadsheet(e){if(e){var t=hot.getSourceData();if((t=beGetModifiedItems(t,window.beOriginalData)).length)return alert(vgse_editor_settings.texts.save_changes_reload_optional),!0}var o=jQuery(".remodal-bg").data("nonce"),r=jQuery("#post-data");window.beOriginalData=[],hot.loadData([]),beLoadPosts({post_type:r.data("post-type"),nonce:o})}function vgseAddFoundRowsCount(e){window.beFoundRows=e,jQuery(".be-total-rows").text(jQuery(".be-total-rows").text().replace(/\d+/,e))}function vgseInputToFormattedColumnField(e,t,o){if(void 0!==vgse_editor_settings.unfiltered_spreadsheet_columns_settings[e]){var r=vgse_editor_settings.unfiltered_spreadsheet_columns_settings[e],n=t.find(o),a=n.attr("name"),i=n.attr("class");if(!n.is("input")&&!n.is("textarea")||n.attr("type")&&"text"!==n.attr("type"))return!0;if(void 0!==r.formatted.editor&&"select"===r.formatted.editor)n.replaceWith('<select class="'+i+'" name="'+a+'"><option value="">('+vgse_editor_settings.texts.empty+")</option></select>"),(s=t.find("select"+o)).each(function(){var o=jQuery(this);jQuery.each(r.formatted.selectOptions,function(e,t){jQuery.isNumeric(e)&&(e=t),o.append('<option value="'+e+'">'+t+"</option>")})});else if(void 0!==r.formatted.type&&"checkbox"===r.formatted.type){var s;n.replaceWith('<input type="checkbox" class="'+i+'" name="'+a+'">'),(s=t.find("input"+o+":checkbox")).change(function(){jQuery(this).is(":checked")?jQuery(this).val(r.formatted.checkedTemplate):jQuery(this).val(r.formatted.uncheckedTemplate)}),s.trigger("change")}}}void 0===Array.prototype.chunk&&Object.defineProperty(Array.prototype,"chunk",{value:function(o){var r=this;return[].concat.apply([],r.map(function(e,t){return t%o?[]:[r.slice(t,t+o)]}))}}),jQuery(document).ajaxError(function(e,t,o,r){loading_ajax({estado:!1}),"boolean"==typeof window.vgseDontNotifyServerError&&window.vgseDontNotifyServerError?window.vgseDontNotifyServerError=!1:"abort"!==t.statusText&&(400==t.status?notification({mensaje:vgse_editor_settings.texts.http_error_400,tipo:"error",tiempo:6e4}):403==t.status?notification({mensaje:vgse_editor_settings.texts.http_error_403,tipo:"error",tiempo:6e4}):500==t.status||502==t.status||505==t.status?notification({mensaje:vgse_editor_settings.texts.http_error_500_502_505,tipo:"error",tiempo:6e4}):503==t.status?notification({mensaje:vgse_editor_settings.texts.http_error_503,tipo:"error",tiempo:6e4}):509==t.status?notification({mensaje:vgse_editor_settings.texts.http_error_509,tipo:"error",tiempo:6e4}):504==t.status?notification({mensaje:vgse_editor_settings.texts.http_error_504,tipo:"error",tiempo:6e4}):notification({mensaje:vgse_editor_settings.texts.http_error_default,tipo:"error",tiempo:6e4}))}),jQuery(document).ajaxComplete(function(e,t,o,r){setTimeout(function(){"abort"!==t.statusText&&window.vgse_editor_settings&&("0"===t.responseText||0===t.responseText||r)&&(loading_ajax({estado:!1}),"boolean"==typeof window.vgseDontNotifyServerError&&window.vgseDontNotifyServerError?window.vgseDontNotifyServerError=!1:notification({mensaje:vgse_editor_settings.texts.http_error_500_502_505,tipo:"error",tiempo:6e4}))},500)});